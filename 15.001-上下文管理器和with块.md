### 15.2 上下文管理器和with块* with语句的目的是简化try/finally模式，这种模式用于保证一段代码* with语句的目的是简化try/finally模式，这种模式用于保证一段代码运行完毕后执行某项操作，即便那段代码由于异常，return语句或sys.exit调用而终止，也会执行指定的操作，finally子句中的代码通常用于释放重要的资源，或者还原临时变更的状态。* 上下文管理器协议包含 `__enter__`和 `__exit__`两个方法，with语句开始运行时，会在上下文管理器对象上调用 `__enter__`方法，with语句结束后会调用 `__exit__`方法。以此扮演finally子句的角色。```>>> from mirror import LookingGlass>>> with LookingGlass() as what: ➊...     print('Alice, Kitty and Snowdrop') ➋...     print(what)...pordwonS dna yttiK ,ecilA ➌YKCOWREBBAJ>>> what ➍'JABBERWOCKY'22>>> print('Back to normal.') ➎Back to normal.``````class LookingGlass:    def __enter__(self): ➊        import sys        self.original_write = sys.stdout.write ➋        sys.stdout.write = self.reverse_write ➌        return 'JABBERWOCKY' ➍    def reverse_write(self, text): ➎        self.original_write(text[::-1])    def __exit__(self, exc_type, exc_value, traceback): ➏        import sys ➐        sys.stdout.write = self.original_write ➑        if exc_type is ZeroDivisionError: ➒            print('Please DO NOT divide by zero!')            return True ➓```* 解释器调用 `__enter__`方法时，除了隐式self外，不会传入任何参数，传给 `__exit__`方法的参数三个：    * exec_type: 异常类    * exec_value: 异常实例，有时会有参数传给异常构造方法，例如错误消息，这些参数可以使用exec_value.args获取    * traceback： traceback对象